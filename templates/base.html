<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>{% block title %}MyDuka{% endblock %}</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="//cdn.datatables.net/2.3.4/css/dataTables.dataTables.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Your custom CSS -->
  <link rel="stylesheet" href="/static/styles/style.css">
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light mb-4 shadow-sm">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold text-primary" href="/">MyDuka</a>

      <!-- Navbar toggle for mobile -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <!-- Left Nav Links -->
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="/"><i class="bi bi-house-door me-1"></i> Home</a></li>

          {% if session.get('user_id') %}
          <li class="nav-item"><a class="nav-link" href="/dashboard"><i class="bi bi-speedometer2 me-1"></i>
              Dashboard</a></li>
          <li class="nav-item"><a class="nav-link" href="/products"><i class="bi bi-box-seam me-1"></i> Products</a>
          </li>
          <li class="nav-item"><a class="nav-link" href="/sales"><i class="bi bi-cart-check me-1"></i> Sales</a></li>
          <li class="nav-item"><a class="nav-link" href="/stock"><i class="bi bi-stack me-1"></i> Stock</a></li>
          <li class="nav-item"><a class="nav-link" href="/profit"><i class="bi bi-graph-up-arrow me-1"></i> Profit</a>
          </li>
          <li class="nav-item"><a class="nav-link text-danger" href="/logout"><i class="bi bi-box-arrow-right me-1"></i>
              Logout</a></li>
          {% else %}
          <li class="nav-item"><a class="nav-link" href="/login"><i class="bi bi-person-circle me-1"></i> Login</a></li>
          <li class="nav-item"><a class="nav-link" href="/register"><i class="bi bi-person-plus me-1"></i> Register</a>
          </li>
          {% endif %}
        </ul>


        <!-- ðŸ” Universal Search Bar -->
        <form method="GET" action="{{ url_for('search') }}" class="d-flex search-form">
          <input class="form-control me-2 search-input" type="search" name="q" placeholder="Search anything..."
            required>
          <button class="btn search-btn" type="submit">Search</button>
        </form>
      </div>
    </div>
  </nav>

  <div class="container">
    {% block content %}{% endblock %}
  </div>

  <!-- JS libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
    integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="//cdn.datatables.net/2.3.4/js/dataTables.min.js"></script>

  <!-- Auto-close modal on submit -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const forms = document.querySelectorAll('.modal form');
      forms.forEach(form => {
        form.addEventListener('submit', () => {
          const modal = bootstrap.Modal.getInstance(form.closest('.modal'));
          if (modal) modal.hide();
        });
      });
    });
  </script>

  <!-- Rainbow Ball Animation -->
  <script>
    const ball = document.getElementById('rainbowBall');
    if (ball) {
      const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet'];
      let colorIndex = 0;
      let direction = 1;
      let position = 20;

      function animate() {
        if (position >= 60 || position <= 20) direction *= -1;
        position += direction * 2;
        ball.style.bottom = position + 'px';
        colorIndex = (colorIndex + 1) % colors.length;
        ball.style.background = colors[colorIndex];
        requestAnimationFrame(animate);
      }

      animate();
    }
  </script>

  <script src="/static/scripts/script.js"></script>

  <!-- Link visible select to hidden select -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const visibleSelect = document.getElementById("visible_pid");
      const hiddenSelect = document.getElementById("pid");
      if (visibleSelect && hiddenSelect) {
        visibleSelect.addEventListener("change", () => {
          hiddenSelect.value = visibleSelect.value;
        });
      }
    });
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
</body>

</html>